<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Angielski dla dzieci â€“ Super Gra</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-100 to-purple-100 min-h-screen flex items-center justify-center">
  <div class="bg-white shadow-2xl rounded-3xl p-6 w-full max-w-lg">
    <h1 class="text-3xl font-extrabold text-center mb-1">ğŸ§  Angielski dla dzieci</h1>
    <p class="text-center text-slate-600 mb-4">SÅ‚uchaj ğŸ‘‚ mÃ³w ğŸ—£ï¸ pisz âœï¸</p>
    <div id="game"></div>
  </div>

<script>
// ================= SÅÃ“WKA =================
const words = [
  { en: "apple", pl: "jabÅ‚ko", emoji: "ğŸ" },
  { en: "banana", pl: "banan", emoji: "ğŸŒ" },
  { en: "orange", pl: "pomaraÅ„cza", emoji: "ğŸŠ" },
  { en: "house", pl: "dom", emoji: "ğŸ " },
  { en: "kitchen", pl: "kuchnia", emoji: "ğŸ³" },
  { en: "sun", pl: "sÅ‚oÅ„ce", emoji: "â˜€ï¸" },
  { en: "rain", pl: "deszcz", emoji: "ğŸŒ§ï¸" },
  { en: "happy", pl: "szczÄ™Å›liwy", emoji: "ğŸ˜Š" },
  { en: "sad", pl: "smutny", emoji: "ğŸ˜¢" },
  { en: "run", pl: "biegaÄ‡", emoji: "ğŸƒ" },
  { en: "jump", pl: "skakaÄ‡", emoji: "ğŸ¤¾" },
  { en: "football", pl: "piÅ‚ka noÅ¼na", emoji: "âš½" },
  { en: "t-shirt", pl: "koszulka", emoji: "ğŸ‘•" }
];

// ================= STAN =================
let roundSize = 10;
let roundWords = [];
let index = 0;
let points = 0;

const gameEl = document.getElementById("game");

// ================= START =================
function startScreen() {
  gameEl.innerHTML = `
    <h2 class="text-xl font-bold text-center mb-4">ğŸ® Zaczynamy?</h2>
    <button class="btn w-full" onclick="startGame()">â–¶ï¸ Start gry</button>
  `;
}

function startGame() {
  roundWords = shuffle([...words]).slice(0, roundSize);
  index = 0;
  points = 0;
  next();
}

// ================= LOGIKA =================
function next() {
  if (index >= roundWords.length) return endRound();

  const w = roundWords[index];
  const speakMode = index % 3 === 0; // co trzecie sÅ‚owo â€“ mÃ³wienie

  if (speakMode) {
    // ===== MÃ“WIENIE PO ANGIELSKU =====
    gameEl.innerHTML = `
      <p class="text-center text-6xl">${w.emoji}</p>
      <p class="text-center text-xl">Powiedz po angielsku:</p>
      <h2 class="text-center text-3xl font-bold">${w.en}</h2>
      <div class="flex justify-center gap-3 mt-4">
        <button class="btn" onclick="speak('${w.en}')">ğŸ”Š PosÅ‚uchaj</button>
        <button class="btn" onclick="listen('${w.en}')">ğŸ¤ Nagraj</button>
      </div>
      <p class="text-center mt-3">â­ ${points} / ${roundWords.length}</p>
    `;
  } else {
    // ===== TÅUMACZENIE NA POLSKI =====
    const options = shuffle(roundWords).slice(0, 3).map(x => x.pl);
    if (!options.includes(w.pl)) options[0] = w.pl;

    gameEl.innerHTML = `
      <p class="text-center text-6xl">${w.emoji}</p>
      <p class="text-center text-xl">Co to znaczy?</p>
      <h2 class="text-center text-3xl font-bold">${w.en}</h2>
      <div class="grid gap-2 mt-4">
        ${options.map(o => `<button class="btn" onclick="checkPL('${o}')">${o}</button>`).join('')}
      </div>
      <p class="text-center mt-3">â­ ${points} / ${roundWords.length}</p>
    `;
  }
}

// ================= SPRAWDZANIE =================
function checkPL(answer) {
  const correct = roundWords[index].pl;
  if (answer === correct) {
    points++;
  } else {
    alert("âŒ Å¹le! Poprawnie: " + correct);
  }
  index++;
  next();
}

function listen(correctEn) {
  if (!('webkitSpeechRecognition' in window)) {
    alert('Nagrywanie gÅ‚osu nie jest obsÅ‚ugiwane');
    return;
  }
  const rec = new webkitSpeechRecognition();
  rec.lang = 'en-US';
  rec.onresult = e => {
    const said = e.results[0][0].transcript.toLowerCase();
    if (said.includes(correctEn.toLowerCase())) {
      points++;
    } else {
      alert("âŒ SprÃ³buj jeszcze raz. Powiedz: " + correctEn);
    }
    index++;
    next();
  };
  rec.start();
}

// ================= KONIEC =================
function endRound() {
  const cup = points >= roundWords.length * 0.8 ? 'ğŸ†' : 'ğŸ–ï¸';
  gameEl.innerHTML = `
    <h2 class="text-3xl text-center font-bold">${cup}</h2>
    <p class="text-center mt-2">Wynik: ${points} / ${roundWords.length}</p>
    <button class="btn w-full mt-4" onclick="startGame()">â–¶ï¸ NastÄ™pna runda</button>
  `;
}

function speak(text) {
  const msg = new SpeechSynthesisUtterance(text);
  msg.lang = 'en-US';
  speechSynthesis.speak(msg);
}

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

startScreen();
</script>

<style>
.btn { background: linear-gradient(to right, #3b82f6, #6366f1); color: white; padding: 10px; border-radius: 1rem; font-weight: bold; }
</style>
</body>
</html>
